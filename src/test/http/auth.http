### 0) signup (A)
POST {{host}}/api/v1/users/signup
Content-Type: application/json

{
  "loginId": "{{loginIdA}}",
  "password": "{{passwordA}}",
  "nickname": "테스트A",
  "email": "devlogA@devlog.com"
}

### Signup demo
POST http://localhost:8080/api/v1/users/signup
Content-Type: application/json

{
  "loginId": "demo",
  "password": "demo1234!",
  "nickname": "데모유저",
  "email": "demo1@devlog.com"
}


### 0-1) signup (B)
POST {{host}}/api/v1/users/signup
Content-Type: application/json

{
  "loginId": "{{loginIdB}}",
  "password": "{{passwordB}}",
  "nickname": "테스트B",
  "email": "devlogB_001@devlog.com"
}

### 1) login (A)
POST {{host}}/api/v1/users/login
Content-Type: application/json

{
  "loginId": "{{loginIdA}}",
  "password": "{{passwordA}}"
}

> {%
    client.global.set("accessToken", response.body.data.accessToken);
    client.global.set("refreshToken", response.body.data.refreshToken);
%}

### 1) login (B)
POST {{host}}/api/v1/users/login
Content-Type: application/json

{
  "loginId": "{{loginIdB}}",
  "password": "{{passwordB}}"
}

> {%
    client.global.set("accessToken", response.body.data.accessToken);
    client.global.set("refreshToken", response.body.data.refreshToken);
%}



### 2) me (access 필요)
GET {{host}}/api/v1/users/me
Authorization: Bearer {{accessToken}}

### 3) reissue (refresh로 access 재발급) -> newAccessToken 저장
POST {{host}}/api/v1/users/reissue
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

> {%
    client.global.set("newAccessToken", response.body.data.accessToken ?? response.body.data.newAccessToken);
%}

### 4) me with NEW access
GET {{host}}/api/v1/users/me
Authorization: Bearer {{newAccessToken}}

### 5) logout (refresh 삭제)
POST {{host}}/api/v1/users/logout
Authorization: Bearer {{accessToken}}

### 6) reissue after logout (should fail)
POST {{host}}/api/v1/users/reissue
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

### =========================
### Post CRUD (A)
### =========================

### Post 생성 (A) -> postId 저장
POST {{host}}/api/v1/posts
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "두 번째 게시글",
  "content": "Day6 Post 생성 테스트2"
}

> {%
    client.global.set("postId", response.body.data.id);
%}

### Post 단건 조회 (A)
GET {{host}}/api/v1/posts/{{postId}}
Authorization: Bearer {{accessToken}}

### Post 목록 조회 (A)
GET {{host}}/api/v1/posts?page=0&size=10
Authorization: Bearer {{accessToken}}

### Post 수정 (A)
PUT {{host}}/api/v1/posts/{{postId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "수정된 제목",
  "content": "수정된 내용"
}

### Post 삭제 (A)
DELETE {{host}}/api/v1/posts/{{postId}}
Authorization: Bearer {{accessToken}}

### =========================
### 403 테스트 (B가 A글 수정 시도)
### =========================

### login (B) -> accessTokenB 저장
POST {{host}}/api/v1/users/login
Content-Type: application/json

{
  "loginId": "{{loginIdB}}",
  "password": "{{passwordB}}"
}

> {%
    client.global.set("accessTokenB", response.body.data.accessToken);
%}

### B가 A글 수정 시도 -> 403 기대
PUT {{host}}/api/v1/posts/{{postId}}
Authorization: Bearer {{accessTokenB}}
Content-Type: application/json

{
  "title": "B 수정 시도",
  "content": "403 떠야 정상"
}


### Comment 생성
POST {{host}}/api/v1/posts/{{postId}}/comments
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "첫 댓글!"
}

> {%
    client.global.set("commentId", response.body.data.id);
%}

### Comment 목록 조회
GET {{host}}/api/v1/posts/{{postId}}/comments
Authorization: Bearer {{accessToken}}

### Comment 수정(작성자)
PUT {{host}}/api/v1/posts/{{postId}}/comments/{{commentId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "댓글 수정!"
}

### Comment 삭제(작성자)
DELETE {{host}}/api/v1/posts/{{postId}}/comments/{{commentId}}
Authorization: Bearer {{accessToken}}
